# {{ ansible_managed }}

# static HTML sites
location = /index.html {
  return 301 /;
}

location = /themes.html {
  return 301 /wordpress-themes/;
}

location = /freebies.html {
  return 301 /wordpress-themes/;
}

location = /contact.html {
  return 301 /contact/;
}

location = /the-team.html {
  return 301 /our-team/;
}

location = /pricelist.html {
  return 301 /services/;
}

location = /jobs.html {
  return 301 /jobs/;
}

location = /pt-pricelist.pdf {
  return 301 /services/;
}

location ^~ /payment-form.php {
  return 301 https://apps.proteusthemes.com/customization-form/$is_args$args;
}

# blog permalinks (remove date and month)
location ~ "^/blog/\d{4}/\d{2}/([a-z0-9-]+)/$" {
  return 301 /blog/$1;
}

# documentation root goes to zendesk article
location = /docs/ {
  return 301 https://support.proteusthemes.com/hc/en-us/articles/202614041-Theme-Documentation;
}

# strip `-pt` from the end of the docs URLs
location ~ "^/docs/(\w+)-pt/?$" {
  return 301 /docs/$1/;
}

# Yoast SEO Sitemaps
location ~ ([^/]*)sitemap(.*).x(m|s)l$ {
  ## this redirects sitemap.xml to /sitemap_index.xml
    rewrite ^/sitemap.xml$ /sitemap_index.xml permanent;
  ## this makes the XML sitemaps work
    rewrite ^/([a-z]+)?-?sitemap.xsl$ /index.php?xsl=$1 last;
    rewrite ^/sitemap_index.xml$ /index.php?sitemap=1 last;
    rewrite ^/([^/]+?)-sitemap([0-9]+)?.xml$ /index.php?sitemap=$1&sitemap_n=$2 last;
}

location = /blog/beginners-guide-setting-automatic-wordpress-backups/ {
  if ($arg_utm_campaign = '6872cf6d64-valentines-day-25off') {
    return 302 https://www.proteusthemes.com/pricing/?utm_source=ProteusThemes+Newsletters&utm_campaign=6872cf6d64-valentines-day-25off&utm_medium=email;
  }
}
